@model LBFC.Models.Entities.Shop

@{
    ViewBag.Title = "Create";
}

<h2>Create</h2>
@Html.LabelFor(q => q.Name)
@Html.TextBoxFor(q => q.Name)
<br />
@Html.LabelFor(q => q.Address)
@Html.TextBoxFor(q => q.Address)

<button onclick="find();">Find</button>
<input type="text" readonly id="long" />
<input type="text" readonly id="lat" />
<br/>
<button type="button" onclick="submit();">Submit</button>
<div id="map" style="width: 500px; height: 300px">
    
</div>

<script>
    
      function initMap() {
        // Create a map object and specify the DOM element for display.
        var map = new google.maps.Map(document.getElementById('map'), {
          center: {lat: -34.397, lng: 150.644},
          zoom: 8
        });
      }
</script>
<script type="text/javascript">
    var shop;
    function find() {
        var address = $('input#Address').val().replace(/ /g, '+');
        $.ajax({
            url: 'https://maps.googleapis.com/maps/api/geocode/json?address=' + address + '&key=AIzaSyBfnn5XNL3H4krCmOBOnwrcSi7ATSDAAtk',
            success: function (result) {
                $("#lat").val(result.results[0].geometry.location.lat);
                $("#long").val(result.results[0].geometry.location.lng);
                var map = new google.maps.Map(document.getElementById('map'), {
                    center: { lat: result.results[0].geometry.location.lat, lng: result.results[0].geometry.location.lng },
                    zoom: 15
                });

                var marker = new google.maps.Marker({
                    position: { lat: result.results[0].geometry.location.lat, lng: result.results[0].geometry.location.lng },
                    map: map,
                });
            }
        });
    }

    function submit() {
        var name = $('input#Name').val();
        var address = $('input#Address').val();
        var lat = $('#lat').val();
        var long = $('#long').val();

        $.ajax({
            url: '/Shop/Create',
            type: 'POST',
            data: {
                Name: name,
                Address: address,
                Latitude: lat,
                Longtitude: long,
            },
            success: function (result) {
                shop = result.shop;
                alert(result.status);
            }
        });
    }
</script>

